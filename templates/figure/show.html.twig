{% extends 'base.html.twig' %}

{% block title %}{{ figure.figureName }}{% endblock %}

{% block body %}
    <div class="figure-name">
        <div class="container ad-title mb-3 bg-primary">
            <h1 style="text-align: center">{{ figure.figureName }}</h1>
        </div>
    </div>

    <div class="container">
        <div class="row mb-3 bg-primary">
            {% for picture in figure.picture %}
                <div class="col-md-2 mt-3 mb-3 d-flex justify-content-center">
                    <img src="{{ picture.url }}" alt="figure" class="image-figure">
                </div>
            {% endfor %}

            {% for video in figure.video %}
                <div class="col-md-2 mt-3 mb-3 d-flex justify-content-center">
                    <img src="{{ video.url }}" alt="Video" class="image-figure">
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="container">
        <div class="row mb-3 bg-primary">
            <div class="offset-md-1 col-10">
                {{ figure.description }}
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-2 mb-3 bg-primary d-flex justify-content-center">
                {{ figure.authorId.nom }} {{ figure.authorId.prenom }}
            </div>
            <div class="offset-md-1 col-md-2 mb-3 bg-primary d-flex justify-content-center">
                {{ figure.groupe.groupeName }}
            </div>
            <div class="offset-md-1 col-md-2 mb-3 bg-primary d-flex justify-content-center">
                {{ figure.creationDate|date("d/m/Y") }}
            </div>
            <div class="offset-md-1 col-md-2 mb-3 bg-primary d-flex justify-content-center">
                {% if figure.modifDate == null %}
                    {% set modifDate = '---' %}
                    {{ modifDate }}
                {% else %}
                    {{ figure.modifDate|date("d/m/Y") }}
                {% endif %}
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row mb-3 bg-primary d-flex justify-content-center">
            {{ form_start(form) }}

            <div class="form-inline">
                <div class="col-md-8 mt-3 mb-3">
                    {{ form_widget(form) }}
                </div>

                <button type="submit" class="col-md-4 mt-3 mb-3 btn btn-secondary">Laisser un commentaire.</button>
            </div>

            {{ form_end(form) }}
        </div>
    </div>

    <div class="container">
        {% for commentaire in commentaires %}
            <div class="row">
                <div class="col-md-1 mb-3 bg-primary d-flex justify-content-center align-items-center">
                    <img src="{{ commentaire.author.avatar }}" alt="Video" class="image-avatar">
                </div>
                
                <div class="{% if app.user and (app.user.roles[0] != 'ROLE_ADMIN') %}offset-md-1{% endif %} col-md-1 mb-3 bg-primary d-flex justify-content-center align-items-center">
                    {{ commentaire.author.nom }} {{ commentaire.author.prenom }}
                </div>

                <div class="{% if app.user and (app.user.roles[0] != 'ROLE_ADMIN') %}offset-md-1{% endif %} col-md-6 mb-3 bg-primary d-flex justify-content-center align-items-center">
                    {{ commentaire.content }}
                </div>

                <div class="{% if app.user and (app.user.roles[0] != 'ROLE_ADMIN') %}offset-md-1{% endif %} col-md-1 mb-3 bg-primary d-flex justify-content-center align-items-center">
                    {{ commentaire.creationDate|date("d/m/Y") }}
                </div>

                {% if app.user and (app.user.roles[0] == 'ROLE_ADMIN') %}
                    <div class="offset-md-1 col-md-1 mb-3 bg-primary d-flex justify-content-center align-items-center">
                        <a href="{{ path('commentaire_supp', {'id': commentaire.id, 'slug': figure.slug}) }}" class="btn btn-danger">
                            <i class="fas fa-trash-alt"></i>
                        </a>
                    </div>
                {% endif %}
            </div>
        {% endfor %}

        {% if pages != 0 %}
            <div class="d-flex justify-content-center">
                <ul class="pagination">
                    <li class="page-item {% if page == 1 %}disabled{% endif %}">
                        <a class="page-link" href="{{path('figure_show', {'slug': figure.slug, 'page': page - 1})}}">&laquo;</a>
                    </li>
                    {% for i in 1..pages %}
                        <li class="page-item {% if page == i %}active{% endif %} bg-primary">
                            <a class="page-link" href="{{path('figure_show', {'slug': figure.slug, 'page': i})}}">{{i}}</a>
                        </li>
                    {% endfor %}
                    <li class="page-item {% if page == pages %}disabled{% endif %}">
                        <a class="page-link" href="{{path('figure_show', {'slug': figure.slug, 'page': page + 1})}}">&raquo;</a>
                    </li>
                </ul>
            </div>
        {% endif %}
    </div>
{% endblock %}